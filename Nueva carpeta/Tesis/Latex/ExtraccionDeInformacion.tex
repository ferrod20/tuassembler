\chapter{Desarrollo}
\section{Extracción de la información} 
El diccionario Cobuild guarda su información en un archivo de texto plano con un formato particular. El primer desafío de este trabajo fué comprender y extraer la información almacenada en ese archivo. A continuación se muestra un pequeño fragmento del mismo para ejemplificar
{\footnotesize
\begin{verbatim}
DICTIONARY_ENTRY
ace
aces
*e*!is    
A person who is ace at something is extremely good at it; an informal use.
...an ace marksman.
classifying adjective
adjective                                

DICTIONARY_ENTRY
ace
aces
*e*!is    
If you say that something is ace, you mean that you think that it is very good; 
an informal use.
Their new records really ace!
qualitative adjective or exclamation
adjective                                
\end{verbatim}
}

Cada entrada arriba presentada tiene la característica de poseer una cantidad variable de campos y no es posible identificarlos exactamente. Sin embargo, contienen algunos rasgos comunes: la palabra, sus formas, la pronunciación, su definición y uno o más ejemplos donde se indica como se emplea (mediante una etiqueta gramatical). Por ejemplo, en la primer entrada se pueden distinguir estos campos:\\ \\
{\footnotesize \verb#DICTIONARY_ENTRY# \\
\verb#ace#  $\longrightarrow$ {\footnotesize \textsl{palabra}}\\
\verb#aces# $\longrightarrow$ {\footnotesize \textsl{formas flexionadas}}\\
\verb#*e*!is# $\longrightarrow$ {\footnotesize \textsl{pronunciación}}\\
\verb#A person who is ace at something is extremely good at it; an informal use.# $\longrightarrow$ {\footnotesize \textsl{definición}}\\
\verb#...an ace marksman.# $\longrightarrow$ {\footnotesize \textsl{ejemplo}}\\
\verb#classifying adjective# $\longrightarrow$ {\footnotesize \textsl{etiqueta específica}}\\
\verb#adjective# $\longrightarrow$ {\footnotesize \textsl{etiqueta general}}}\\ 
  
Estas entradas, que conforman el diccionario Cobuild y que constituyen la fuente de información principal sobre la cual se basa este trabajo, fueron cuidadosamente procesadas y refinadas intentando mantener toda la información disponible. El primer desafío de esta etapa consistió en recuperar las entradas con toda la información gramatical disponible; explícita e implícita. Una primer tarea fué reconocer y registrar información relacionada a las formas flexionadas de la palabra (plurales, pasados, etc.), es decir, obtener información gramatical implícita.

\subsection{Reconocimiento de formas flexionadas} 
En muchas entradas del diccionario Cobuild ocurre la palabra, uno o más ejemplos en donde ésta aparece con cierto sentido (indicado por medio de etiquetas gramaticales) pero dentro de los ejemplos hay apariciones de formas flexionadas. Tomemos la siguiente entrada:\\ \\
{\footnotesize \verb#DICTIONARY_ENTRY# \\
\verb#bite#  $\longrightarrow$ {\footnotesize \textsl{palabra}}\\
\verb#bites, biting, bit, bitten# $\longrightarrow$ {\footnotesize \textsl{formas flexionadas}}\\
\verb#b*a*!it# $\longrightarrow$ {\footnotesize \textsl{pronunciación}}\\
\verb#If an object or surface bites, it grips another object or surface rather than slipping on it or against it..# $\longrightarrow$ {\footnotesize \textsl{definición}}\\
\verb#Let the clutch in slowly until it begins to bite.# $\longrightarrow$ {\footnotesize \textsl{ejemplo}}\\
\verb#verb# $\longrightarrow$ {\footnotesize \textsl{etiqueta específica}}\\
\verb#verb# $\longrightarrow$ {\footnotesize \textsl{etiqueta general}}}\\

Aquí arriba se puede observar una entrada del diccionario para la palabra \emph{bite}, que contiene la definición y un ejemplo de esta palabra con sus respectivas etiquetas:\\

(1) \emph{If an object or surface bites, it grips another object or surface rather than slipping
on it or against it.}\\

(2) \emph{Let the clutch in slowly until it begins to bite.}\\
\\
En (2) aparece la palabra \emph{bite} en su forma regular con la etiqueta \emph{verb} mientras que en (1) aparece la forma flexionada \emph{bites} con la etiqueta \emph{verb}. En este caso (1) está ofreciendo más información gramatical que la expuesta por medio de la etiqueta. Reconociendo la forma flexionada (\emph{bites}) podemos adicionarle información extra a la etiqueta \emph{verb}; en vez de guardar la etiqueta \emph{Penn Treebank} correspondiente a \emph{verb} (VB), en este caso guardaríamos la etiqueta  VBZ (verbo de tiempo presente en tercera persona singular) que contiene más información gramatical que VB.

Las entradas de Cobuild exponen las formas derivadas de la palabra que pueden contener los ejemplos. En el ejemplo presentado anteriormente la palabra es \emph{bite} y las formas derivadas de \emph{bite} que muestra la entrada son \emph{bites, biting, bit} y \emph{bitten}. Con esta información y la etiqueta que fué anotada en Cobuild (\emph{verb}) se pueden inferir y generar etiquetas de \emph{Penn Treebank} con información adicional. 

Como ya se mencionó anteriormente, en este caso la forma \emph{bites} (derivada de la palabra \emph{bite}) que aparece en la definición posee la etiqueta \emph{verb}. La tarea aquí será reconocer que \emph{bites} es un verbo de tiempo presente en tercera persona singular a partir de que \emph{bites} está etiquetada como verbo y de que la palabra de la cual deriva es \emph{bite}. Es decir, inferir el tipo de la forma derivada a partir de la palabra y la etiqueta asignada por Cobuild.

Con el objetivo de identificar las formas derivadas de una palabra se desarrollaron reglas y métodos para su reconocimiento, buscando preservar y aprovechar toda  la información que ofrece Cobuild. Entonces, a partir de esta información: la palabra, la forma en que ocurre y la etiqueta asignada se aplican las siguientes reglas para reconocer información adicional a la etiqueta gramatical.

\floatname{algorithm}{Algoritmo}
\begin{algorithm}
\caption{Reconocimiento de formas derivadas}
\begin{algorithmic}
\STATE Traducir la etiqueta asignada por Cobuild a PenTreeBank
\STATE Si la etiqueta obtenida es
\STATE
\STATE \textbf{JJ}:
\STATE\hspace{\algorithmicindent} Si la forma termina en \textsl{er} o empieza en \textsl{more} o \textsl{less} aplicar \textbf{JJR}
\STATE\hspace{\algorithmicindent} Si la forma termina en \textsl{est} o empieza en \textsl{most} o \textsl{least} aplicar \textbf{JJS}
\STATE
\STATE \textbf{RB}:
\STATE\hspace{\algorithmicindent}Si la forma termina en \textsl{er} o empieza en \textsl{more} o \textsl{less} aplicar \textbf{RBR}
\STATE\hspace{\algorithmicindent}Si la forma termina en \textsl{est} o empieza en \textsl{most} o \textsl{least} aplicar \textbf{RBS}
\STATE
\STATE \textbf{NN}:
\STATE\hspace{\algorithmicindent} Si la forma termina en \textsl{s} aplicar \textbf{NNS}
\STATE
\STATE \textbf{VB}:
\STATE\hspace{\algorithmicindent} Si la forma termina en \textsl{ed} aplicar \textbf{VBD$|$VBN}

\STATE\hspace{\algorithmicindent} Si la forma termina en \textsl{ing} aplicar \textbf{VBG}
\STATE\hspace{\algorithmicindent} Si la forma termina en \textsl{s} aplicar \textbf{VBZ}
\end{algorithmic}
\end{algorithm}

Aplicando algoritmos de extracción y el algoritmo de reconocimiento de formas derivadas explicado anteriormente se obtiene un nuevo corpus parcialemente anotado a partir del diccionario Cobuild. A continuación este corpus será procesado y utilizado como corpus de entrenamiento.

\subsection{Preprocesamiento} 
Se tomó el archivo cobuild en bruto, se hizo un primer preprocesado elminando caracteres no ascii para que puediera ser legible.
Luego se separó cada entrada y se procesó individualmente identificando el/los ejemplos de cada entrada, la palabra que se está definiendo y su etiqueta asociada.
También se tuvieron en cuenta palabras derivadas y cuando fué posible (cuando no hubo ambiguedad) se infirieron etiquetas para las mismas.
Luego se tradujeron las etiquetas de Cobuild a Penn Tree Bank, para esto se utilizó un diccionario construído a doc. No fué posible incluir todas las etiquetas Cobuild, ya que no se conoce el formato concreto de las mismas ni pertenecen a ningún conjunto de etiquetas documentado. Sin embargo se realizó un análisis para contar las etiquetas Cobuild que más se repetían y en base a esas etiquetas se construyó la traducción.
También cabe aclarar que las etiquetas Cobuild son muy ricas sintácticamente y un poco de esa información se perdió en la traducción ya que las etiquetas Penn Treebank carecen de ese nivel de detalle.

Una vez realizado este proceso, verificamos que el etiquetado haya sido correcto. 
Se realizó una rutina que etiquetara automáticamente todos los ejemplos de Cobuild (se utilizó el etiquetador TnT) y se comparó el resultado contra las etiquetas asignadas (se generó una matriz de confusión). El resultado fué de 71\% de aciertos. Se analizaron las etiquetas que diferían con mayor frecuencia, y en algunos casos se analizaron palabras particulares donde las etiquetas no coincidían. Se corrigieron las traducciones y se ajustaron los algoritmos del proceso de extracción y traducción de etiqueteas hasta alcanzar un grado de error mínimo. Los máximos focos de error que no se pudieron corregir se deben a palabras etiquetadas con VBD cuando son VBN y viceversa. Estas etiquetas son dificilmente desmbiguables automaticamente.

Una vez obtenidos los ejemplos con las etiquetas traducidas a Penn Treebank, se realiza un nuevo proceso para obtener precisión gramatical perdida en la traducción

Para eso se comparan las etiquetas asignadas contra las etiquetas asignadas automáticamente por TnT. En caso de coincidir y en caso de que la etiqueta TnT aporte  mayor precisión, se asigna esta última. Se utilizó el siguiente algoritmo:\\\\

\floatname{algorithm}{Algoritmo}
\begin{algorithm}
\caption{Obtener la etiqueta de mayor detalle gramatical}
\begin{algorithmic}
\STATE
\STATE Si se obtuvo de Cobuild la etiqueta:
\STATE
\STATE \textbf{NN}:
\STATE\hspace{\algorithmicindent} y TnT asignó NNS, NNP o NNPS, asignar la etiqueta de TnT
\STATE
\STATE \textbf{NNS}:
\STATE\hspace{\algorithmicindent} y TnT asignó NNPS, asignar NNPS
\STATE
\STATE \textbf{VB}:
\STATE\hspace{\algorithmicindent} y TnT asignó VBN, VBD, VBZ, VBP o VBG, asignar la etiqueta de TnT
\STATE
\STATE \textbf{JJ}:
\STATE\hspace{\algorithmicindent} y TnT asignó JJR o JJS, asignar la etiqueta de TnT
\STATE
\STATE \textbf{RB}:
\STATE\hspace{\algorithmicindent} y TnT asignó RBR o RBS, asignar la etiqueta de TnT
\STATE
\STATE \textbf{WP}:
\STATE\hspace{\algorithmicindent} y TnT asignó asigno WP\$, asignar WP\$
\STATE
\STATE \textbf{PRP}:
\STATE\hspace{\algorithmicindent} y TnT asignó asigno PRP\$, asignar PRP\$
\STATE
\end{algorithmic}
\end{algorithm}

Luego de este proceso, el análisis de comparación contra las etiquetas asignadas por TnT dió un 86\% de aciertos.
